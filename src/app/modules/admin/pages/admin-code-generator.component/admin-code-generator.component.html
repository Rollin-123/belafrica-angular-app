<div class="bel-admin-generator-container">
  
  <header class="bel-generator-header">
    <h1>ğŸ”‘ GÃ©nÃ©rateur de Codes Admin</h1>
    <p>GÃ©nÃ©rez des codes courts pour les administrateurs des communautÃ©s</p>
  </header>

  <div class="bel-generator-content">
    
    <form [formGroup]="codeForm" (ngSubmit)="generateCode()" class="bel-generator-form">
      
      <div class="bel-form-grid">
        
        <div class="bel-form-group">
          <label class="bel-form-label">ğŸ‡ªğŸ‡º Pays de rÃ©sidence *</label>
          <select formControlName="countryCode" class="bel-form-select">
            <option value="">Choisissez un pays</option>
            <option *ngFor="let country of europeanCountries" [value]="country.code">
              {{ country.name }}
            </option>
          </select>
        </div>

        <div class="bel-form-group">
          <label class="bel-form-label">ğŸŒ NationalitÃ© africaine *</label>
          <select formControlName="nationality" class="bel-form-select">
            <option value="">Choisissez une nationalitÃ©</option>
            <option *ngFor="let nationality of africanNationalities" [value]="nationality">
              {{ nationality }}
            </option>
          </select>
        </div>

        <!-- PrÃ©visualisation communautÃ© -->
        <div class="bel-form-group" *ngIf="codeForm.get('countryName')?.value && codeForm.get('nationality')?.value">
          <label class="bel-form-label">ğŸ  CommunautÃ© gÃ©nÃ©rÃ©e</label>
          <div class="bel-community-preview">
            <strong>{{ getPreviewCommunity() }}</strong>
            <small>Cette communautÃ© sera crÃ©Ã©e automatiquement</small>
          </div>
        </div>

        <!-- Email de l'admin -->
        <div class="bel-form-group">
          <label class="bel-form-label">ğŸ“§ Email de l'admin *</label>
          <input 
            type="email" 
            formControlName="userEmail"
            placeholder="admin@exemple.com"
            class="bel-form-input">
          <div *ngIf="codeForm.get('userEmail')?.invalid && codeForm.get('userEmail')?.touched" 
               class="bel-error-message">
            âš ï¸ Email invalide
          </div>
        </div>

        <!-- Niveau de permissions -->
<div class="bel-form-group">
  <label class="bel-form-label">ğŸ‘‘ Niveau d'administration *</label>
  <div class="bel-permission-options">
    <label *ngFor="let level of permissionLevels" class="bel-permission-option">
      <input 
        type="radio" 
        formControlName="permissionLevel"
        [value]="level.value"
        class="bel-radio-input">
      <span class="bel-radio-custom"></span>
      <span class="bel-permission-content">
        <strong>{{ level.label }}</strong>
        <small>{{ level.description }}</small>
        <span class="bel-permission-badge" [class]="level.value">
          {{ level.badge }}
        </span>
      </span>
    </label>
  </div>
</div>
        <!-- DurÃ©e de validitÃ© -->
        <div class="bel-form-group">
          <label class="bel-form-label">â° ValiditÃ© du code *</label>
          <select formControlName="expiresIn" class="bel-form-select">
            <option [value]="24">24 heures</option>
            <option [value]="48">48 heures</option>
            <option [value]="168">7 jours</option>
          </select>
          <small>Expire le : {{ getExpiryDate(codeForm.get('expiresIn')?.value || 24) }}</small>
        </div>

      </div>

      <!-- Bouton de gÃ©nÃ©ration -->
      <button 
        type="submit" 
        class="bel-btn-primary bel-generate-btn"
        [disabled]="!codeForm.valid || isLoading">
        
        <span *ngIf="!isLoading" class="bel-btn-content">
          <span class="bel-btn-icon">ğŸ”‘</span>
          GÃ©nÃ©rer le Code Admin
        </span>
        
        <span *ngIf="isLoading" class="bel-btn-content">
          <span class="bel-loading-spinner"></span>
          GÃ©nÃ©ration en cours...
        </span>
      </button>

    </form>

    <!-- Code gÃ©nÃ©rÃ© -->
    <div *ngIf="generatedCode && showCode" class="bel-generated-code">
      <div class="bel-code-header">
        <h3>âœ… Code Admin GÃ©nÃ©rÃ©</h3>
        <p>Code envoyÃ© par email Ã  l'administrateur</p>
      </div>
      
      <div class="bel-code-display">
        <code class="bel-jwt-code">{{ generatedCode }}</code>
        
        <div class="bel-code-actions">
          <button (click)="copyToClipboard()" class="bel-btn-secondary">
            ğŸ“‹ Copier le code
          </button>
          <button (click)="sendByEmail()" class="bel-btn-secondary">
            ğŸ“§ Renvoyer l'email
          </button>
        </div>
        
        <div class="bel-code-info">
  <p><strong>ğŸ“§ Email :</strong> {{ codeForm.get('userEmail')?.value }}</p>
  <p><strong>ğŸ  CommunautÃ© :</strong> {{ getPreviewCommunity() }}</p>
  <p><strong>â° Expire dans :</strong> {{ codeForm.get('expiresIn')?.value }} heures</p>
  <p><strong>ğŸ‘‘ Permissions :</strong> {{ getPermissionLabel() }}</p>
</div>
      </div>
    </div>

    <!-- Historique des codes gÃ©nÃ©rÃ©s -->
    <div class="bel-recent-codes" *ngIf="generatedCodes.length > 0">
      <h3>ğŸ“œ Codes Actifs RÃ©cemment GÃ©nÃ©rÃ©s</h3>
      <div class="bel-codes-list">
        <div *ngFor="let code of generatedCodes" class="bel-code-item">
          <div class="bel-code-details">
            <strong class="bel-code-value">{{ code.code }}</strong>
            <span class="bel-code-community">{{ code.community }}</span>
            <span class="bel-code-email">{{ code.userEmail }}</span>
            <span class="bel-code-expiry">Expire: {{ code.expiresAt | date:'dd/MM HH:mm' }}</span>
          </div>
          <!-- ğŸš¨ Bouton de suppression ajoutÃ© -->
          <button (click)="deleteCode(code)" class="bel-btn-icon-only bel-btn-delete" title="Supprimer le code">
           <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path><line x1="10" y1="11" x2="10" y2="17"></line><line x1="14" y1="11" x2="14" y2="17"></line></svg>
          </button>
        </div>
      </div>
    </div>

  </div>

</div>
<div class="bel-admin-request-container">

  <header class="bel-admin-header">
    <button (click)="goBack()" class="bel-back-btn">‚Üê Retour</button>
    <h1>Devenir Administrateur</h1>
    <p>Publiez du contenu pour votre communaut√© apr√®s v√©rification manuelle</p>
  </header>

  <div class="bel-admin-process">

    <!-- Statut Admin -->
    @if (isAdmin) {
      <div class="bel-admin-status success">
        <div class="bel-status-icon">‚úÖ</div>
        <div class="bel-status-content">
          <h3>Administrateur Actif</h3>
          <p>Vous pouvez maintenant publier du contenu pour la communaut√© <strong>{{ user?.community }}</strong></p>
        </div>
      </div>
    }

    <!-- Demande en attente -->
    @if (hasPendingRequest && !isAdmin) {
      <div class="bel-admin-status pending">
        <div class="bel-status-icon">‚è≥</div>
        <div class="bel-status-content">
          <h3>Demande en Cours de Traitement</h3>
          <p>Votre demande est en cours de v√©rification manuelle par l'administrateur principal (Rollin Loic Tianga).</p>
          <p class="bel-status-note">Vous recevrez le code de validation par email si votre profil est approuv√© (d√©lai : 24-48h).</p>
        </div>
      </div>
    }

    <!-- Processus de demande -->
    @if (!hasPendingRequest && !isAdmin) {
      <div class="bel-admin-steps">
        <!-- √âtape 1 : Information -->
        <div class="bel-admin-step">
          <div class="bel-step-header">
            <span class="bel-step-number">&#64;</span>
            <h3>Processus de V√©rification</h3>
          </div>
          <p>Pour garantir la s√©curit√© de notre communaut√©, chaque administrateur est v√©rifi√© manuellement.</p>
          <div class="bel-requirements">
            <h4>üìã Documents Requis :</h4>
            <ul class="bel-requirements-list">
              <li>üì∏ <strong>Photo de pi√®ce d'identit√©</strong> (passeport, carte d'identit√© ou permis)</li>
              <li>üí¨ <strong>Explication de votre motivation</strong> (minimum 50 caract√®res)</li>
              <li>‚è≥ <strong>D√©lai de traitement :</strong> 24-48 heures</li>
            </ul>
          </div>
        </div>
        <!-- √âtape 2 : Formulaire -->
        <form [formGroup]="adminForm" (ngSubmit)="submitRequest()" class="bel-admin-form">
          <div class="bel-form-group">
            <label class="bel-form-label">
              üì∏ Photo de Pi√®ce d'Identit√© *
              <span class="bel-required">*</span>
            </label>
            <div class="bel-passport-upload" [class.has-image]="passportPreview">
              <div class="bel-passport-preview">
                @if (passportPreview) {
                  <img
                    [src]="passportPreview"
                    class="bel-passport-image"
                    alt="Aper√ßu pi√®ce d'identit√©">
                }
                @if (!passportPreview) {
                  <div class="bel-passport-placeholder">
                    <div class="bel-placeholder-icon">üìÑ</div>
                    <p class="bel-placeholder-text">Cliquez pour prendre une photo</p>
                    <small>Format accept√© : JPG, PNG (max. 5MB)</small>
                  </div>
                }
              </div>
              <div class="bel-upload-controls">
                <input
                  type="file"
                  #passportInput
                  (change)="onPassportSelected($event)"
                  accept="image/jpeg,image/png"
                  capture="environment"
                  class="bel-file-input">
                  <button
                    type="button"
                    class="bel-btn-secondary bel-upload-btn"
                    (click)="passportInput.click()">
                    <span class="bel-btn-icon">üì∑</span>
                    Prendre une Photo
                  </button>
                  <div class="bel-upload-hints">
                    <p class="bel-hint">üí° <strong>Conseils :</strong></p>
                    <ul class="bel-hints-list">
                      <li>Photo bien √©clair√©e et lisible</li>
                      <li>Masquez les informations sensibles si n√©cessaire</li>
                      <li>Seule la photo sera visible par le cr√©ateur</li>
                    </ul>
                  </div>
                </div>
              </div>
              @if (adminForm.get('passportPhoto')?.invalid && adminForm.get('passportPhoto')?.touched) {
                <div
                  class="bel-error-message">
                  ‚ö†Ô∏è Une photo de pi√®ce d'identit√© est requise
                </div>
              }
            </div>
            <!-- Information additionnelle -->
            <div class="bel-form-group">
              <label for="additionalInfo" class="bel-form-label">
                üí¨ Votre Motivation *
                <span class="bel-required">*</span>
              </label>
              <textarea
                id="additionalInfo"
                formControlName="additionalInfo"
                placeholder="Expliquez pourquoi vous souhaitez devenir administrateur et comment vous comptez contribuer √† la communaut√©..."
                rows="5"
                maxlength="500"
                class="bel-form-textarea"
                [class.invalid]="adminForm.get('additionalInfo')?.invalid && adminForm.get('additionalInfo')?.touched">
              </textarea>
              <div class="bel-textarea-meta">
                <span class="bel-char-count">
                  {{ adminForm.get('additionalInfo')?.value?.length || 0 }}/500 caract√®res
                </span>
                @if (adminForm.get('additionalInfo')?.invalid && adminForm.get('additionalInfo')?.touched) {
                  <span
                    class="bel-error-text">
                    Minimum 50 caract√®res requis
                  </span>
                }
              </div>
            </div>
            <!-- Confidentialit√© -->
            <div class="bel-privacy-notice">
              <div class="bel-privacy-icon">üîí</div>
              <div class="bel-privacy-content">
                <h4>Confidentialit√© Garantie</h4>
                <p>Votre pi√®ce d'identit√© est envoy√©e uniquement au cr√©ateur de BELAFRICA et sera supprim√©e apr√®s v√©rification.</p>
              </div>
            </div>
            <!-- Bouton de soumission -->
            <button
              type="submit"
              class="bel-btn-primary bel-submit-btn"
              [disabled]="!adminForm.valid || isLoading"
              [class.loading]="isLoading">
              @if (!isLoading) {
                <span class="bel-btn-content">
                  <span class="bel-btn-icon">üì®</span>
                  Soumettre ma Demande
                </span>
              }
              @if (isLoading) {
                <span class="bel-btn-content">
                  <span class="bel-loading-spinner"></span>
                  Envoi en cours...
                </span>
              }
            </button>
          </form>
        </div>
      }

      <!-- Section Code Admin -->
      @if (!isAdmin) {
        <div class="bel-admin-code-section">
          <div class="bel-code-header">
            <h3>üîë Code de Validation</h3>
            @if (!hasPendingRequest) {
              <p>Si vous avez d√©j√† re√ßu un code apr√®s v√©rification :</p>
            }
          </div>
          <div class="bel-code-input-group">
            <input
              type="text"
              [(ngModel)]="adminCode"
              placeholder="Entrez votre code JWT ici..."
              class="bel-code-input"
              [class.has-code]="adminCode"
              [disabled]="hasPendingRequest">
              <button
                (click)="validateAdminCode()"
                class="bel-btn-secondary bel-validate-btn"
                [disabled]="!adminCode || hasPendingRequest"
                [class.loading]="validatingCode">
                @if (!validatingCode) {
                  <span>‚úÖ Valider</span>
                }
                @if (validatingCode) {
                  <span class="bel-loading-spinner small"></span>
                }
              </button>
            </div>
            @if (codeError) {
              <div class="bel-code-error">
                ‚ùå {{ codeError }}
              </div>
            }
          </div>
        }

      </div>

      <footer class="bel-admin-footer">
        <div class="bel-contact-card">
          <div class="bel-contact-header">
            <span class="bel-contact-icon">üìû</span>
            <h4>Support & Contact</h4>
          </div>

          <div class="bel-contact-info">
            <p><strong>Email du cr√©ateur :</strong> rollinloictianga&#64;gmail.com</p>
            <p><strong>D√©lai de traitement :</strong> 24-48 heures maximum</p>
            <p class="bel-contact-note">Pour toute question concernant votre demande d'administration</p>
          </div>
        </div>
      </footer>

    </div>

<div class="bel-container">
  <div class="bel-card">

    <div class="bel-auth-header">
      <app-logo size="medium"></app-logo>
    </div>

    <div style="margin-bottom: var(--bel-spacing-xl);">
      <h2 class="bel-title" style="text-align: left; font-size: 28px; margin-bottom: var(--bel-spacing-sm);">
        Quelle est votre nationalit√© ?
      </h2>
      <p class="bel-subtitle" style="text-align: left; margin-bottom: 0;">
        Cette information nous aide √† vous connecter √† la bonne communaut√© africaine.
        <strong style="color: var(--bel-color-accent);">Votre nationalit√© ne pourra pas √™tre modifi√©e.</strong>
      </p>
    </div>

    <!-- Formulaire de s√©lection -->
    <form [formGroup]="nationalityForm" (ngSubmit)="onSubmit()">

      <!-- S√©lection de la nationalit√© -->
      <div style="margin-bottom: var(--bel-spacing-xl);">
        <label style="display: block; margin-bottom: var(--bel-spacing-sm); font-weight: 600;">
          S√©lectionnez votre nationalit√©
        </label>

        <!-- Container personnalis√© pour le select -->
        <div class="bel-select-container">
          <select
            formControlName="nationality"
            class="bel-select"
            [class.selected]="nationalityForm.get('nationality')?.value">

            <option value="">-- Choisissez votre nationalit√© --</option>
            @for (country of africanCountries; track country) {
              <option
                [value]="country.code"
                [attr.data-flag]="country.flag">
                {{ country.flag }} {{ country.name }}
              </option>
            }
          </select>

          <!-- Ic√¥ne fl√®che personnalis√©e -->
          <div class="bel-select-arrow">‚ñº</div>
        </div>

        <!-- Aper√ßu de la s√©lection -->
        @if (nationalityForm.get('nationality')?.value) {
          <div
            class="bel-selection-preview">
            <span class="bel-preview-flag">{{ selectedCountryFlag }}</span>
            <span class="bel-preview-text">Nationalit√© s√©lectionn√©e : <strong>{{ selectedCountryName }}</strong></span>
          </div>
        }

        <!-- Message d'erreur -->
        @if (nationalityForm.get('nationality')?.invalid && nationalityForm.get('nationality')?.touched) {
          <small
            class="bel-error-message">
            ‚ö†Ô∏è Veuillez s√©lectionner votre nationalit√©
          </small>
        }
      </div>

      <!-- Pays de r√©sidence d√©tect√© -->
      @if (detectedCountry) {
        <div class="bel-detected-country">
          <div class="bel-country-badge">
            <span class="bel-badge-icon">üåç</span>
            <span class="bel-badge-text">
              <strong>Pays de r√©sidence :</strong> {{ detectedCountry }}
            </span>
          </div>
          <!-- Information importante -->
          @if (selectedCountryName) {
            <div class="bel-info-box">
              <p style="margin: 0; font-size: 13px; color: var(--bel-dark);">
                Votre communaut√© :
                <strong>{{ communityPreview }}</strong> <br>
                üí° Vous rejoindrez la communaut√© <strong>{{ selectedCountryName }}</strong>
                r√©sidant en <strong>{{ detectedCountry }}</strong>
              </p>
            </div>
          }
        </div>
      }

      <!-- Message d'erreur g√©n√©ral -->
      @if (errorMessage) {
        <div class="bel-alert-error">
          <span class="bel-alert-icon">‚ùå</span>
          <span class="bel-alert-text">{{ errorMessage }}</span>
        </div>
      }

      <!-- Boutons -->
      <div class="bel-buttons-container">
        <button
          type="submit"
          class="bel-btn-primary"
          [disabled]="!nationalityForm.valid || isLoading">
          @if (!isLoading) {
            <span>Continuer vers le profil</span>
          }
          @if (isLoading) {
            <span>Chargement...</span>
          }
        </button>

        <button
          type="button"
          class="bel-btn-secondary"
          (click)="goBack()">
          ‚Üê Retour
        </button>
      </div>

    </form>
  </div>
</div>